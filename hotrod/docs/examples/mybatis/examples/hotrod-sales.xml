<?xml version="1.0"?>
<!DOCTYPE hotrod-fragment SYSTEM "hotrod-fragment.dtd">

<hotrod-fragment>

  <facet name="visits-dev">

    <table name="visit" />

  </facet>

  <table name="purchase">
    <auto-generated-column name="id" />
  </table>

  <dao java-class-name="GeneralOperations">

    <!-- Native SQL - Insert Special Column Type -->
    <query java-method-name="insertPreferredColors">
    <![CDATA[
      insert into preferred_colors (id, colors) values (
        #{id,javaType=java.lang.Integer, jdbcType=NUMERIC},
        (
          #{color1,javaType=java.lang.String, jdbcType=VARCHAR},
          #{color2,javaType=java.lang.String, jdbcType=VARCHAR},
          #{color3,javaType=java.lang.String, jdbcType=VARCHAR}
        )
      )
    ]]>
    </query>

    <!-- Dynamic SQL - Update Unsold Vehicles -->
    <query java-method-name="applyDiscountToVehicles">
    <![CDATA[
      update vehicle set
          list_price = list_price - #{discount,javaType=java.lang.Integer,jdbcType=NUMERIC}
        <where>
          <if test="#{unsold,javaType=java.lang.Boolean,jdbcType=BOOLEAN} != null">
            and not sold
          </if>
          <if test="#{minMileage,javaType=java.lang.Integer,jdbcType=NUMERIC} != null">
            and mileage > #{minMileage}
          </if>
          <if test="#{type,javaType=java.lang.String,jdbcType=VARCHAR} != null">
            and type = #{type}
          </if>
        </where>
    ]]>
    </query>

  </dao>

</hotrod-fragment>
