==========================
=== Apache Derby 10.13 ===
==========================
Allows identity            : yes
Allows identity by default : yes 
Find if column is identity : yes
--------------------------

create table test_identity1 (
  id int not null primary key generated always as identity,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- FAILS!

insert into test_identity1 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity1 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity1;

-- 1, Chicago
-- 2, Oregon

create table test_identity2 (
  id int not null primary key generated by default as identity,
  name varchar(100)
);

insert into test_identity2 (name) values ('Chicago'); -- succeeds

insert into test_identity2 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity2 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity2 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity2;

-- 1, Chicago
-- 4, Denver
-- 2, Oregon

--------------------------

select 
    case when autoincrementvalue is null then 'N/A' when columndefault is null then 'ALWAYS' else 'BY DEFAULT' end
  from sys.sysschemas s
  join sys.systables t on (t.schemaid) = (s.schemaid)
  join sys.syscolumns c on (c.referenceid) = (t.tableid)
  where s.schemaname = 'SCHEMA1' and t.tablename = 'TEST_IDENTITY2' and c.columnname = 'ID'
  
-- N/A: no autogeneration
-- ALWAYS: generated always as identity
-- BY DEFAULT: generated by default as identity

==========================
=== DB2 10.5           ===
==========================
Allows identity            : yes 
Allows identity by default : yes
Find if column is identity : 
--------------------------

create table test_identity1 (
  id int not null primary key generated always as identity,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- FAILS!

insert into test_identity1 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity1 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity1;

-- 1, Chicago
-- 2, Oregon

create table test_identity2 (
  id int not null primary key generated by default as identity,
  name varchar(100)
);

insert into test_identity2 (name) values ('Chicago'); -- succeeds

insert into test_identity2 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity2 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity2 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity2;

-- 1, Chicago
-- 4, Denver
-- 2, Oregon

--------------------------

select
    case when generated = 'A' then 'ALWAYS' when generated = 'D' then 'BY DEFAULT' else 'N/A' end
  from sysibm.syscolumns
  where tbname = 'TEST_IDENTITY1'
    and name = 'ID'

==========================
=== H2 1.3             ===
==========================
Allows identity            : 
Allows identity by default : 
Find if column is identity : 
--------------------------

drop table test_identity1;

create table test_identity1 (
  id int not null identity primary key,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity1 (id, name) values (null, 'Kansas'); -- succeeds

insert into test_identity1 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity1;

-- 1, Chicago
-- 4, Denver
-- 5, Kansas
-- 6, Oregon

--------------------------

select
    case when sequence_name is null then 'N/A' else 'BY DEFAULT' end
  from information_schema.columns
  where table_schema = 'PUBLIC'
    and table_name = 'TEST_IDENTITY1'
    and column_name = 'ID'

==========================
=== HyperSQL 2.2       ===
==========================
Allows identity            : 
Allows identity by default : 
Find if column is identity : 
--------------------------

drop table test_identity0;
drop table test_identity1;
drop table test_identity2;
drop table test_identity3;
drop table test_identity4;


create table test_identity0 (
  id int not null primary key,
  name varchar(100)
);


create table test_identity1 (
  id int generated always as identity not null primary key,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- FAILS!

insert into test_identity1 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity1 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity1;

-- 0, Chicago
-- 1, Oregon


create table test_identity2 (
  id int generated by default as identity not null primary key,
  name varchar(100)
);

insert into test_identity2 (name) values ('Chicago'); -- succeeds

insert into test_identity2 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity2 (id, name) values (null, 'Kansas'); -- succeeds

insert into test_identity2 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity2;

-- 0, Chicago
-- 4, Denver
-- 5, Kansas
-- 6, Oregon


create sequence my_seq3;

create table test_identity3 (
  id int generated by default as sequence my_seq3 not null primary key, -- works like a BY DEFAULT identity
  name varchar(100)
);

insert into test_identity3 (name) values ('Chicago'); -- succeeds

insert into test_identity3 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity3 (id, name) values (null, 'Kansas'); -- succeeds

insert into test_identity3 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity3;

-- 0, Chicago
-- 1, Kansas
-- 2, Oregon
-- 4, Denver


create table test_identity4 (
  firstname varchar(20),
  lastname varchar(20), 
  id varchar(40) generated always as (firstname || ' ' || lastname) primary key -- not autogenerated -> N/A
);

insert into test_identity4 (firstname, lastname) values ('Felix', 'the Cat');

insert into test_identity4 (firstname, lastname) values ('Pink', 'Panther');

select * from test_identity4;

--------------------------

select 
    case when identity_generation in ('ALWAYS', 'BY DEFAULT') then identity_generation else 'N/A' end
  from information_schema.columns
  where table_catalog = 'PUBLIC' -- always 'PUBLIC'
    and table_schema = 'SCHEMA1' -- the specific schema
    and table_name = 'TEST_IDENTITY1'
    and column_name = 'ID'

==========================
=== MySQL 5.5          ===
==========================
Allows identity            : yes
Allows identity by default : yes 
Find if column is identity : yes
--------------------------

drop table test_identity1;

create table test_identity1 (
  id int not null primary key auto_increment,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity1 (id, name) values (null, 'Kansas'); -- succeeds

insert into test_identity1 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity1;

-- 1, Chicago
-- 4, Denver
-- 5, Kansas
-- 6, Oregon

--------------------------

select
    case when extra = 'auto_increment' then 'BY DEFAULT' else 'N/A' end
  from information_schema.columns 
  where table_schema = 'database1'
    and (table_name = 'test_identity0' or table_name = 'test_identity1')
    and column_name = 'id';

==========================
=== Oracle 12c         ===
==========================
Allows identity            : 
Allows identity by default : 
Find if column is identity : 
--------------------------

==========================
=== PostgreSQL 9.4     ===
==========================
Allows identity            : 
Allows identity by default : 
Find if column is identity : 
--------------------------

drop table test_identity0;
drop table test_identity1;

create table test_identity0 (
  id int not null primary key,
  name varchar(100)
);

create table test_identity1 (
  id serial not null primary key,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- succeeds

insert into test_identity1 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity1 (id, name) values (default, 'Oregon'); -- succeeds

select * from test_identity1;

-- 1, Chicago
-- 4, Denver
-- 2, Oregon

--------------------------

For a column to be an IDENTITY it must satisfy two conditions:

 * The default value of the column must take the form (with a variable SEQUENCE_NAME):

    nextval('SEQUENCE_NAME'::regclass)

   - First, retrieve the sequence name from the default constraint:
 
select column_default 
  from information_schema.columns
  where table_name = 'table_name' 
    and column_name = 'column_name'

   - If the row does not take the form described above, then it's not an IDENTITY
     column. If it's found and has the form described above, then retrieve the 
     SEQUENCE_NAME. Sometimes the SEQUENCE_NAME is wrapped in double quotes; if this
     is the case, remove the double quotes to use it in the second part.
 
 * Second, find the sequence name in the relationships table:

select 1 as identity
  from pg_catalog.pg_class
  where relkind = 'S'
    and relname = 'SEQUENCE_NAME'
    
   - A single row should be returned with a single column with value 1. If this
     is the case then it's an BY DEFAULT identity.
   - Otherwise it's not an IDENTITY column.
 
 * If not found on either these queries, then it's not an IDENTITY column.

==========================
=== SAP ASE 16         ===
==========================
Allows identity            : 
Allows identity by default : 
Find if column is identity : 
--------------------------

create table test_identity0 (
  id int not null primary key,
  name varchar(100)
);

create table test_identity1 (
  id int identity not null primary key,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- FAILS!

insert into test_identity1 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity1 (id, name) values (default, 'Oregon'); -- FAILS!

select * from test_identity1;

-- 1, Chicago

To find out if a column is an ALWAYS identity the following SQL must find it:

select 1    
  from syscolumns 
  where object_name(id) = 'table'
    and name = 'column'
    and status & 128 = 128

If it doesn't find it, then it's not an identity. 
There are no BY DEFAULT identities (in any practical way, at least).

=======================
=== SQL Server 2014 ===
=======================
Allows identity            : 
Allows identity by default : 
Find if column is identity : 
--------------------------

create table test_identity0 (
  id int not null primary key,
  name varchar(100)
);

create table test_identity1 (
  id int identity not null primary key,
  name varchar(100)
);

insert into test_identity1 (name) values ('Chicago'); -- succeeds

insert into test_identity1 (id, name) values (4, 'Denver'); -- FAILS!

insert into test_identity1 (id, name) values (null, 'Kansas'); -- FAILS!

insert into test_identity1 (id, name) values (default, 'Oregon'); -- FAILS!

select * from test_identity1;

-- 1, Chicago

--------------------------

select case when c.is_identity = 1 then 'ALWAYS' else 'N/A' end
  from sys.objects o 
  join sys.columns c on o.object_id = c.object_id
  where o.name = 'test_identity0'
    and c.name = 'id'















