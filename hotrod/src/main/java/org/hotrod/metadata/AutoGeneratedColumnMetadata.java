package org.hotrod.metadata;

import org.hotrod.config.AutoGeneratedColumnTag;
import org.hotrod.database.DatabaseAdapter;
import org.hotrod.exceptions.UnresolvableDataTypeException;
import org.hotrod.utils.identifiers.ColumnIdentifier;

public class AutoGeneratedColumnMetadata {

  private DataSetMetadata dataSet;
  private ColumnMetadata columnMetadata;
  private AutoGeneratedColumnTag tag;
  private DatabaseAdapter adapter;

  public AutoGeneratedColumnMetadata(final DataSetMetadata dataSet, final AutoGeneratedColumnTag tag,
      final DatabaseAdapter adapter) throws UnresolvableDataTypeException {
    this.dataSet = dataSet;
    this.tag = tag;
    this.adapter = adapter;
    this.columnMetadata = new ColumnMetadata(dataSet, tag.getJdbcColumn(), this.adapter, null, false, true);
  }

  public DataSetMetadata getDataSet() {
    return dataSet;
  }

  public ColumnMetadata getColumnMetadata() {
    return columnMetadata;
  }

  public boolean isIdentity() {
    return this.tag.isIdentity();
  }

  public boolean supportsJDBCGeneratedKeys() {
    return this.adapter.supportsJDBCGeneratedKeys();
  }

  public ColumnIdentifier getIdentifier() {
    return this.columnMetadata.getIdentifier();
  }

  public boolean allowsSpecifiedValue() {
    return this.tag.allowsSpecifiedValue();
  }

  public String getSequence() {
    return this.tag.getSequence();
  }

}
