<?xml version="1.0"?>
<!DOCTYPE hotrod-fragment>

<hotrod-fragment package="accounting.finances">

  <facet name="phase2">

    <dao java-class-name="Dao3" />

  </facet>

  <table name="quadrant">
    <column name="active_state" converter="boolean_stored_as_number_4" />
  </table>

  <facet name="seq">

  </facet>

  <facet name="phase2">

    <table name="types_date_time" />

    <select java-class-name="AccountTx1">
      select a.* , t.*
      from account a, transaction t
      <complement>
        where t.account_id = a.id
        and current_balance between #{minBalance,javaType=java.lang.Integer,jdbcType=NUMERIC}
        and #{maxBalance,javaType=java.lang.Integer,jdbcType=NUMERIC}
      </complement>
    </select>

    <select java-class-name="SearchedAccount">
      select * from account
      <complement>
        <where>
          <if test="#{type,javaType=java.lang.String,jdbcType=VARCHAR} != null">
            and type = #{type}
          </if>
          <if test="#{minBalance,javaType=java.lang.Integer,jdbcType=NUMERIC} != null">
            and current_balance >= #{minBalance}
          </if>
        </where>
        order by created_on
      </complement>
    </select>

    <select java-class-name="SearchedAccount2">
      select * from account
      <complement>
        where current_balance &lt;
        #{minBalance,javaType=java.lang.Integer,jdbcType=NUMERIC}
      </complement>
    </select>

  </facet>

  <facet name="types">

    <select java-class-name="SelectTypesNumeric">
      select * from types_numeric
    </select>

    <select java-class-name="SelectTypesChar">
      select * from types_char
    </select>

    <select java-class-name="SelectTypesBinary">
      select * from types_binary
    </select>

    <select java-class-name="SelectTypesDateTime">
      select * from types_date_time
    </select>

    <select java-class-name="SelectViewExtra">
      select * from types_extra
    </select>

  </facet>


  <!-- This is a bad example to test special cases. Do not use as a reference. -->

  <select java-class-name="selectDynamic001">

    <column name="current_balance" java-type="java.lang.Integer" />

    select * from account

    <complement>

<!--
      <bind name="pattern" value="'%' + _parameter.getTitle() + '%'" />
-->

      <if test="conditional">
        <!-- comment 1 -->
        where
        <if test="state">
          state = 'active'

          <choose>
            <!-- comment 2 -->
            <when test="#{sdize,javaType=java.lang.String,jdbcType=VARCHAR} != 'M'">
              and size &lt;&amp; 15
              and size &amp;lt; 30
            </when>
            <when test="#{sdize} == 'S'">
              and size = 'S'
              <if test="#{color,javaType=java.lang.String,jdbcType=VARCHAR} != null">
                and color = 'red'
              </if>
            </when>
            <otherwise>
              and size = 'M'
            </otherwise>
          </choose>

<!--
          <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
            #{item}
          </foreach>
-->

        </if>
        <if test="current_balance">
          balance between 100 and 200
        </if>

        <where>
          <if test="cond2">and a = 10 </if>
          <if test="cond3">and b = 12 </if>
        </where>

        <trim prefix="abc" prefixOverrides="AND |OR " suffix="," suffixOverrides=")">
          <if test="cond2">and a = 10 </if>
          <if test="cond3">and b = 12 </if>
        </trim>

        <set>
          <if test="abc">
            Look.
          </if>
        </set>

      </if>

    </complement>

  </select>

</hotrod-fragment>
