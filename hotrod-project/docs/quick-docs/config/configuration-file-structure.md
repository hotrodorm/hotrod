# Configuration File Structure

HotRod generates code according to the metadata retrieved from a live existing database (a *sandbox* database) that 
typically resides in the development environment.

Although database engines provide a copious amount of metadata for tables and other database objects, some
external metadata is still needed for the generation, as well as some extra configuration to tailor the
resulting persistence to each specific application. These extra details fall into the following categories:

- **Extra Metadata**: metadata inspection strategies, enums, sequences to use with each table, extra schemas to inspect, etc.
- **Generation Details**: base directories, package structure, object naming strategies, data type rules, foreign key generation, optimistic locking details, custom columns, data converters, etc.
- **Nitro Queries**: flat queries, general purpose queries, structured queries.
- **Project Structure**: Configuration fragments, generation facets.

## The Configuration File

The configuration file takes the general form:

```xml
<?xml version="1.0"?>
<!DOCTYPE hotrod SYSTEM "hotrod.dtd">

<hotrod>

  <generators />
  <name-solver />
  <type-solver />
  
  <table />
  <view />
  <enum />
  <dao />
  <converter />
  <facet />
  <fragment />
  
</hotrod>
```

The general structure follow the rules below:

- The persistence-wide tags can only be included in the main configuration file. These are: `<generators>`, `<name-solver>` (optional), and `<type-solver>` (optional).

- Then, there can be zero or more `<table>`, `<view>`, `<enum>`, `<dao>`, `<converter>`, `<facet>`, and/or `<fragment>` tags; 
they can be mixed and included in any order.

- `<facet>` tags must be named and can include zero or more `<table>`, `<view>`, `<enum>`, `<dao>` tags. All included tags will be considered part of the facet.

- `<fragment>` tags must reference a fragment file where extra configuration is specified. Fragments can include other fragments. In any case, any given fragment 
can only be included once in the configuration tree.


## The Fragment File Structure

A configuration fragment is a separate file that includes sections of the configuration, and in turn can include more fragments.

A fragment can include zero or more `<table>`, `<view>`, `<enum>`, `<dao>`, `<converter>`, `<facet>` and `<fragment>` tags. The main purpose of 
fragments is to separate the configuration into multiple files in order to reduce source code collisions when multiple developers are 
modifying the configuration simultaneously. This most commonly happens to [Nitro Queries](../nitro/nitro-queries.md) that need to be tweaked, expanded, 
and/or added frequently.

It's a common practice to separate fragments by application module and/or by the UI. Queries that are expected to suffer constant changes or improvements should be separated from more stable ones, or from the main configuration.

A fragment configuration file takes the general form:

```xml
<?xml version="1.0"?>
<!DOCTYPE hotrod-fragment>

<hotrod-fragment>

  <table />
  <view />
  <enum />
  <dao />
  <converter />
  <facet />
  <fragment />

</hotrod-fragment>
```

## General Structure

The complete structure of HotRod's main configuration file is shown below:

* [`<hotrod>`](hotrod.md)
    * [`<generators>`](generators.md)
        * [`<mybatis-spring>`](mybatis-spring.md)
            * [`<daos>`](daos.md)
            * [`<mappers>`](mapper.md)
            * [`<select-generation>`](select-generation.md)
            * [`<classic-fk-navigation>`](classic-fk-navigation-mybatis-spring.md)
            * [`<property>`](property.md)
        * `<mybatis>` *obsolete*
        * `<spring-jdbc>` *obsolete*
    * [`<name-solver>`](name-solver.md)
        * [`<name>`](name.md)
    * [`<type-solver>`](type-solver.md)
        * [`<when>`](when-type-solver.md)
    * [`<table>`](table.md)
        * [`<column>`](column.md)
        * [`<classic-fk-navigation>`](classic-fk-navigation-table.md)
        * [`<auto-generated-column>`](auto-generated-column.md)
        * [`<version-control-column>`](version-control-column.md)
        * [`<sequence>`](sequence.md)
        * [`<query>`](query.md)
            * `<parameter>`
            * *Dynamic SQL*: Any number of flat or nested [`<if>`](id.md), [`<choose>`](choose.md), [`<where>`](where.md), [`<set>`](set.md), [`<trim>`](trim.md), [`<foreach>`](foreach.md), [`<bind>`](bind.md)
        * [`<select>`](select.md)
            * [`<parameter>`](parameter.md)
            * [`<column>`](column.md)
            * [`<columns>`](columns.md)
                * [`<vo>`](vo.md)
                   * [`<association>`](association.md)
                     * `<association>`
                     * `<collection>`
                     * `<expression>`
                   * [`<collection>`](collection.md)
                        * `<association>`
                        * `<collection>`
                        * `<expression>`
                   * [`<expression>`](expression.md)
                * `<association>`
                * `<expression>`
            * [`<complement>`](complement.md)
                * *Dynamic SQL*
    * [`<enum>`](enum.md)
        * [`<non-persistent>`](non-persistent.md)
    * [`<view>`](view.md)
        * `<column>`
        * `<sequence>`
        * `<query>`
        * `<select>`
    * [`<dao>`](dao.md)
        * `<sequence>`
        * `<query>`
        * `<select>`
    * [`<fragment>`](fragment.md)
    * [`<facet>`](facet.md)
        * `<table>`
        * `<enum>`
        * `<view>`
        * `<dao>`
    * [`<converter>`](converter.md)

The structure of a HotRod's fragment configuration file is:

 * [`<hotrod-fragment>`](hotrod-fragment.md)
    * `<table>`
    * `<enum>`
    * `<view>`
    * `<dao>`
    * `<fragment>`
    * `<facet>`
    * `<converter>`


## See Also

- [`<name-solver>`](name-solver.md) tag
- [`<type-solver>`](type-solver.md) tag
- [Nitro Queries](../nitro/nitro-queries.md)
 
 
 